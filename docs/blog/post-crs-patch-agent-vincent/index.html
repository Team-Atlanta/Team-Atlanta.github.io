<!doctype html><html itemscope lang=en-us itemtype=http://schema.org/WebPage><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=theme-name content="hugoplate"><link rel="shortcut icon" href=/images/team-icon_hu_42d46689e5457328.png type=image/x-icon><link rel=icon href=/images/team-icon_hu_42d46689e5457328.png type=image/x-icon><link rel=icon type=image/png sizes=48x48 href=/images/team-icon_hu_fe460b572c629e4d.png><link rel=icon type=image/png sizes=96x96 href=/images/team-icon_hu_42d46689e5457328.png><link rel=apple-touch-icon sizes=144x144 href=/images/team-icon_hu_47fac973bbab3080.png><link rel=manifest href=/manifest.webmanifest><meta name=msapplication-TileColor content="#ddd"><meta name=theme-color content="#ffffff"><base href=https://team-atlanta.github.io/blog/post-crs-patch-agent-vincent/><title>Vincent, One Puzzle for Our Ensemble Toward High-quality Patches</title><meta name=keywords content="DARPA AIxCC,cybersecurity,fuzzing,LLM,AIxCC"><meta name=description content="Overview of the Vicent agent, one of patching agents in Atlantis-Patch."><meta property="og:image" content="https://team-atlanta.github.io/images/blog/crs-patch/integration.png"><meta name=twitter:image content="https://team-atlanta.github.io/images/blog/crs-patch/integration.png"><meta name=twitter:card content="summary_large_image"><meta property="og:image:width" content="1024"><meta property="og:image:height" content="498"><meta property="og:image:type" content="image/.png"><meta property="og:title" content="Vincent, One Puzzle for Our Ensemble Toward High-quality Patches"><meta property="og:description" content="Overview of the Vicent agent, one of patching agents in Atlantis-Patch."><meta property="og:type" content="website"><meta property="og:url" content="https://team-atlanta.github.io/blog/post-crs-patch-agent-vincent/"><meta name=twitter:title content="Vincent, One Puzzle for Our Ensemble Toward High-quality Patches"><meta name=twitter:description content="Overview of the Vicent agent, one of patching agents in Atlantis-Patch."><script async src="https://www.googletagmanager.com/gtag/js?id=G-SKJZ8R4CQM"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-SKJZ8R4CQM")}</script><script>let indexURL="https://team-atlanta.github.io/searchindex.json",includeSectionsInSearch=["blog"],search_no_results="0 results for",search_initial_message=""</script><meta http-equiv=x-dns-prefetch-control content="on"><link rel=preconnect href=https://use.fontawesome.com crossorigin><link rel=preconnect href=//cdnjs.cloudflare.com><link rel=preconnect href=//www.googletagmanager.com><link rel=preconnect href=//www.google-analytics.com><link rel=dns-prefetch href=https://use.fontawesome.com><link rel=dns-prefetch href=//ajax.googleapis.com><link rel=dns-prefetch href=//cdnjs.cloudflare.com><link rel=dns-prefetch href=//www.googletagmanager.com><link rel=dns-prefetch href=//www.google-analytics.com><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//connect.facebook.net><link rel=dns-prefetch href=//platform.linkedin.com><link rel=dns-prefetch href=//platform.twitter.com><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600&family=Signika:wght@500;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script><link crossorigin=anonymous media=all rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV crossorigin=anonymous><link href="/css/style.min.4272e1c451e8311ec21fa87ec3e6a233579c712a7aa3958bab648a5a2fbd3ffa.css" integrity="sha256-QnLhxFHoMR7CH6h+w+aiM1eccSp6o5WLq2SKWi+9P/o=" rel=stylesheet><link defer async rel=stylesheet href="/css/style-lazy.min.2d0ef26e665343e03222a05c4441afc4c64e2fe91876ad2e185301bf7bb559ab.css" integrity="sha256-LQ7ybmZTQ+AyIqBcREGvxMZOL+kYdq0uGFMBv3u1Was=" media=print onload='this.media="all",this.onload=null'></head><body><header class="header header-modern sticky top-0 z-30"><nav class="navbar container"><div class=order-0><a class="navbar-brand block" href=/>Team Atlanta</a></div><input id=nav-toggle type=checkbox class=hidden>
<label for=nav-toggle class="order-3 cursor-pointer flex items-center lg:hidden text-dark dark:text-white lg:order-1 p-2 rounded-lg hover:bg-theme-light dark:hover:bg-darkmode-theme-light transition-colors duration-300"><svg id="show-button" class="h-6 fill-current block transition-transform duration-300" viewBox="0 0 20 20"><title>Menu Open</title><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0V0z"/></svg>
<svg id="hide-button" class="h-6 fill-current hidden transition-transform duration-300" viewBox="0 0 20 20"><title>Menu Close</title><polygon points="11 9 22 9 22 11 11 11 11 22 9 22 9 11 -2 11 -2 9 9 9 9 -2 11 -2" transform="rotate(45 10 10)"/></svg></label><ul id=nav-menu class="navbar-nav order-3 hidden lg:flex w-full pb-6 lg:order-1 lg:w-auto lg:space-x-2 lg:pb-0 xl:space-x-8"><li class=nav-item><a class="nav-link relative px-4 py-2 rounded-lg transition-all duration-300 hover:bg-theme-light dark:hover:bg-darkmode-theme-light focus-modern" href=/>Home</a></li><li class="nav-item nav-dropdown group relative"><a href=/authors/ class="nav-link
inline-flex items-center">AIxCC Team
<svg class="h-4 w-4 fill-current" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg></a><ul class="nav-dropdown-list lg:group-hover:visible lg:group-hover:opacity-100"><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-leader>Team Leader</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-multilang>Atlantis-Multilang</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-c>Atlantis-C</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-java>Atlantis-Java</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-patch>Atlantis-Patch</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-sarif>Atlantis-SARIF</a></li><li class=nav-dropdown-item><a class=nav-dropdown-link href=/authors/#team-infra>Atlantis-Infra</a></li></ul></li><li class=nav-item><a class="nav-link relative px-4 py-2 rounded-lg transition-all duration-300 hover:bg-theme-light dark:hover:bg-darkmode-theme-light focus-modern" href=/artifacts/>Research & Code</a></li><li class=nav-item><a class="nav-link relative px-4 py-2 rounded-lg transition-all duration-300 hover:bg-theme-light dark:hover:bg-darkmode-theme-light focus-modern" href=/news/>News</a></li><li class=nav-item><a class="nav-link relative px-4 py-2 rounded-lg transition-all duration-300 hover:bg-theme-light dark:hover:bg-darkmode-theme-light focus-modern" href=/blog/>Blog</a></li></ul><div class="order-1 ml-auto flex items-center md:order-2 lg:ml-0"><button aria-label=search class="border-border text-dark hover:text-primary dark:border-darkmode-border mr-5 inline-block border-r pr-5 text-xl dark:text-white dark:hover:text-darkmode-primary p-2 rounded-lg hover:bg-theme-light dark:hover:bg-darkmode-theme-light transition-all duration-300 focus-modern" data-target=search-modal>
<i class="fa-solid fa-search"></i></button><div class="theme-switcher mr-5"><input id=theme-switcher data-theme-switcher type=checkbox>
<label for=theme-switcher><span class=sr-only>theme switcher</span>
<span><svg class="absolute left-[4px] top-[4px] z-10 opacity-100 dark:opacity-0" viewBox="0 0 56 56" fill="#fff" height="16" width="16"><path d="M30 4.6c0-1-.9-2-2-2a2 2 0 00-2 2v5c0 1 .9 2 2 2s2-1 2-2zm9.6 9a2 2 0 000 2.8c.8.8 2 .8 2.9.0L46 13a2 2 0 000-2.9 2 2 0 00-3 0zm-26 2.8c.7.8 2 .8 2.8.0.8-.7.8-2 0-2.9L13 10c-.7-.7-2-.8-2.9.0-.7.8-.7 2.1.0 3zM28 16A12 12 0 0016 28a12 12 0 0012 12 12 12 0 0012-12A12 12 0 0028 16zm23.3 14c1.1.0 2-.9 2-2s-.9-2-2-2h-4.9a2 2 0 00-2 2c0 1.1 1 2 2 2zM4.7 26a2 2 0 00-2 2c0 1.1.9 2 2 2h4.9c1 0 2-.9 2-2s-1-2-2-2zm37.8 13.6a2 2 0 00-3 0 2 2 0 000 2.9l3.6 3.5a2 2 0 002.9.0c.8-.8.8-2.1.0-3zM10 43.1a2 2 0 000 2.9c.8.7 2.1.8 3 0l3.4-3.5c.8-.8.8-2.1.0-2.9s-2-.8-2.9.0zm20 3.4c0-1.1-.9-2-2-2a2 2 0 00-2 2v4.9c0 1 .9 2 2 2s2-1 2-2z"/></svg>
<svg class="absolute left-[4px] top-[4px] z-10 opacity-0 dark:opacity-100" viewBox="0 0 24 24" fill="none" height="16" width="16"><path fill="#000" fill-rule="evenodd" clip-rule="evenodd" d="M8.2 2.2c1-.4 2 .6 1.6 1.5-1 3-.4 6.4 1.8 8.7a8.4 8.4.0 008.7 1.8c1-.3 2 .5 1.5 1.5v.1A10.3 10.3.0 0112.4 22 10.3 10.3.0 013.2 6.7c1-2 2.9-3.5 4.9-4.4z"/></svg></span></label></div><script>var themeSwitch,darkMode=!1;window.matchMedia("(prefers-color-scheme: dark)").matches&&(darkMode=!0),localStorage.getItem("theme")==="dark"?darkMode=!0:localStorage.getItem("theme")==="light"&&(darkMode=!1),darkMode&&document.documentElement.classList.toggle("dark"),themeSwitch=document.querySelectorAll("[data-theme-switcher]"),document.addEventListener("DOMContentLoaded",()=>{[].forEach.call(themeSwitch,function(e){e.checked=!!darkMode,e.addEventListener("click",()=>{document.documentElement.classList.toggle("dark"),localStorage.setItem("theme",document.documentElement.classList.contains("dark")?"dark":"light")})})})</script></div></nav></header><div class=search-modal aria-hidden=true style=--color-primary:#4a5d7a><div data-target=close-search-modal class=search-modal-overlay></div><div class=search-wrapper data-image=true data-description=true data-tags=true data-categories=true><div class=search-wrapper-header><label for=search-modal-input style=margin-top:-1px><span class=sr-only>search icon</span>
<svg viewBox="0 0 512 512" height="18" width="18" class="search-icon" data-type="search"><path fill="currentColor" d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8.0 45.3s-32.8 12.5-45.3.0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9.0 208S93.1.0 208 0 416 93.1 416 208zM208 352a144 144 0 100-288 144 144 0 100 288z"/></svg>
<svg viewBox="0 0 512 512" height="18" width="18" class="search-reset" data-type="reset"><path fill="currentColor" d="M256 512A256 256 0 10256 0a256 256 0 100 512zM175 175c9.4-9.4 24.6-9.4 33.9.0l47 47 47-47c9.4-9.4 24.6-9.4 33.9.0s9.4 24.6.0 33.9l-47 47 47 47c9.4 9.4 9.4 24.6.0 33.9s-24.6 9.4-33.9.0l-47-47-47 47c-9.4 9.4-24.6 9.4-33.9.0s-9.4-24.6.0-33.9l47-47-47-47c-9.4-9.4-9.4-24.6.0-33.9z"/></svg>
</label><input id=search-modal-input type=text data-search-input autocomplete=off aria-label=Search placeholder="Search Post ..."></div><div class=search-wrapper-body><div class=search-result data-search-result></div><span class=search-result-empty></span></div><div class=search-wrapper-footer><span><kbd><svg width="14" height="14" fill="currentColor" viewBox="0 0 16 16"><path d="M3.204 11h9.592L8 5.519 3.204 11zm-.753-.659 4.796-5.48a1 1 0 011.506.0l4.796 5.48c.566.647.106 1.659-.753 1.659H3.204a1 1 0 01-.753-1.659z"/></svg>
</kbd><kbd><svg width="14" height="14" fill="currentColor" style="margin-top:1px" viewBox="0 0 16 16"><path d="M3.204 5h9.592L8 10.481 3.204 5zm-.753.659 4.796 5.48a1 1 0 001.506.0l4.796-5.48c.566-.647.106-1.659-.753-1.659H3.204a1 1 0 00-.753 1.659z"/></svg>
</kbd>to navigate
</span><span><kbd><svg width="12" height="12" fill="currentColor" style="display:inline-block" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M14.5 1.5a.5.5.0 01.5.5v4.8a2.5 2.5.0 01-2.5 2.5H2.707l3.347 3.346a.5.5.0 01-.708.708l-4.2-4.2a.5.5.0 010-.708l4-4a.5.5.0 11.708.708L2.707 8.3H12.5A1.5 1.5.0 0014 6.8V2a.5.5.0 01.5-.5z"/></svg>
</kbd>to select
</span><span class=search-result-info></span>
<span data-target=close-search-modal><kbd>ESC</kbd> to close</span></div></div></div><main><section class="section py-10 blog-single"><div class=container><div class="row justify-center"><article class=lg:col-10><div class=mb-10><picture><source srcset=/images/blog/crs-patch/integration_hu_1b3a37e2aa927ff.webp media="(max-width: 575px)"><source srcset=/images/blog/crs-patch/integration_hu_d149a154cb862f17.webp media="(max-width: 767px)"><source srcset=/images/blog/crs-patch/integration_hu_d69f53438487c35f.webp media="(max-width: 991px)"><source srcset=/images/blog/crs-patch/integration_hu_9b44e7c15368a948.webp><img loading=lazy decoding=async src=/images/blog/crs-patch/integration_hu_76e6d029994ced1e.png class="w-full rounded img" alt="Vincent, One Puzzle for Our Ensemble Toward High-quality Patches" width=1024 height=498></picture></div><h1 class="h2 mb-4">Vincent, One Puzzle for Our Ensemble Toward High-quality Patches</h1><ul class=mb-4><li class="mr-4 inline-block"><i class="fa-regular fa-user-group mr-2 text-primary"></i>
<a href=/authors/younggi-park/>Younggi Park</a>,
<a href=/authors/insu-yun/>Insu Yun</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-folder mr-2"></i>
<a href=/categories/atlantis-patch/ class=ms-1>Atlantis patch</a></li><li class="mr-4 inline-block"><i class="fa-regular fa-clock mr-2"></i>
October 10, 2025</li></ul><div class="toc-container glass-card mb-6 p-4 rounded-lg"><h3 class="toc-title mb-3 text-lg font-semibold text-white flex items-center"><i class="fa-solid fa-list mr-2"></i>
Table of Contents
<button class="toc-toggle ml-auto text-sm" onclick=toggleTOC()>
<i class="fa-solid fa-chevron-up" id=toc-icon></i></button></h3><div class=toc-content id=toc-content><nav id=TableOfContents><ol><li><a href=#right-root-cause-wrong-patches>Right Root cause, Wrong Patches</a></li><li><a href=#guiding-llms-toward-the-right-way-property-analysis-layer>Guiding LLMs Toward the Right Way: Property-Analysis Layer</a></li><li><a href=#workflow-of-vincent-agent>Workflow of Vincent Agent</a></li><li><a href=#code-retrieval-of-vincent-agent>Code Retrieval of Vincent Agent</a></li><li><a href=#conclusion>Conclusion</a></li></ol></nav></div></div><script>function toggleTOC(){const e=document.getElementById("toc-content"),t=document.getElementById("toc-icon");e.classList.contains("collapsed")?(e.classList.remove("collapsed"),t.classList.remove("fa-chevron-down"),t.classList.add("fa-chevron-up"),e.style.maxHeight=e.scrollHeight+"px"):(e.classList.add("collapsed"),t.classList.remove("fa-chevron-up"),t.classList.add("fa-chevron-down"),e.style.maxHeight="0px")}document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("toc-content");e&&(e.style.maxHeight=e.scrollHeight+"px"),initializeBackToTop()});function initializeBackToTop(){const e=document.getElementById("back-to-top");if(!e)return;window.addEventListener("scroll",function(){window.pageYOffset>300?e.classList.remove("hidden"):e.classList.add("hidden")}),e.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})})}</script><div class="fixed bottom-8 right-8 z-50"><button id=back-to-top class="hidden bg-primary text-white w-14 h-14 rounded-full shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" aria-label="Back to top">
<i class="fa-solid fa-arrow-up"></i></button></div><div class="content mb-10"><p>As mentioned in the previous post, our strategy for patching is to prepare multiple agents to ensure both the robustness and correctness of the system.
To this end, we developed various patch agents, each specialized for different LLM models and tools.</p><p>In this post, we would like to introduce Vincent agent, one of the patch agents running under our ensemble-based patching system.</p><h2 id=right-root-cause-wrong-patches>Right Root cause, Wrong Patches</h2><p>What surprised us during the competition was that LLMs alone are already quite doing well at generating proper patches.
Given a sanitizer report, LLMs could freely explore the codebase by itself and reason correctly about the given bug—especially when the problematic code appeared near the call stacks in the report.</p><p>However, our patch agent consistently struggled with the following (seemingly) simple challenge.
The challenge is a double-free bug in the <code>nginx</code> provided by the AIxCC organizer, where the bug is placed in the <code>ngx_http_process_prefer</code> in the <code>ngx_http_request.c</code>.
(If interested, the actual challenge can be found in <a href=https://github.com/aixcc-public/challenge-004-nginx-cp/blob/main/.internal_only/cpv10/patches/nginx/good_patch.diff target=_blank>here</a>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>static</span> <span style=color:#66d9ef>ngx_int_t</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ngx_http_process_prefer</span>(<span style=color:#66d9ef>ngx_http_request_t</span> <span style=color:#f92672>*</span>r, <span style=color:#66d9ef>ngx_table_elt_t</span> <span style=color:#f92672>*</span>h,
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ngx_uint_t</span> offset)
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ngx_table_elt_t</span> <span style=color:#f92672>*</span>p;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (r<span style=color:#f92672>-&gt;</span>headers_in.prefer) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ngx_log_error</span>(NGX_LOG_INFO, r<span style=color:#f92672>-&gt;</span>connection<span style=color:#f92672>-&gt;</span>log, <span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;client sent duplicate host header: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>%V: %V</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>, &#34;</span>
</span></span><span style=display:flex><span>                      <span style=color:#e6db74>&#34;previous value: </span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>%V: %V</span><span style=color:#ae81ff>\&#34;</span><span style=color:#e6db74>&#34;</span>,
</span></span><span style=display:flex><span>                      <span style=color:#f92672>&amp;</span>h<span style=color:#f92672>-&gt;</span>key, <span style=color:#f92672>&amp;</span>h<span style=color:#f92672>-&gt;</span>value, <span style=color:#f92672>&amp;</span>r<span style=color:#f92672>-&gt;</span>headers_in.prefer<span style=color:#f92672>-&gt;</span>key,
</span></span><span style=display:flex><span>                      <span style=color:#f92672>&amp;</span>r<span style=color:#f92672>-&gt;</span>headers_in.prefer<span style=color:#f92672>-&gt;</span>value);
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ngx_free</span>(r<span style=color:#f92672>-&gt;</span>headers_in.prefer); <span style=color:#75715e>// double-free
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>        <span style=color:#66d9ef>return</span> NGX_OK;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    p <span style=color:#f92672>=</span> <span style=color:#a6e22e>ngx_alloc</span>(<span style=color:#66d9ef>sizeof</span>(<span style=color:#66d9ef>ngx_table_elt_t</span>), r<span style=color:#f92672>-&gt;</span>connection<span style=color:#f92672>-&gt;</span>log);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span>p) {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>ngx_http_finalize_request</span>(r, NGX_HTTP_BAD_REQUEST);
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> NGX_ERROR;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>hash <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>hash;
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>key.len <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>key.len;
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>key.data <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>key.data;
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>value.len <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>value.len;
</span></span><span style=display:flex><span>    p<span style=color:#f92672>-&gt;</span>value.data <span style=color:#f92672>=</span> h<span style=color:#f92672>-&gt;</span>value.data;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    r<span style=color:#f92672>-&gt;</span>headers_in.prefer <span style=color:#f92672>=</span> p;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> NGX_OK;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><code>ngx_http_process_prefer</code> is a function that handles Prefer headers in the given HTTP request.
It first checks if any prefer header already exists. If so, the function decides that the current request is invalid. It logs the current request and free the previously allocated object.
Otherwise, it allocates the <code>ngx_table_elt_t</code> and store the provided prefer header information.</p><pre tabindex=0><code>GET / HTTP/1.1
Host: localhost
Prefer: FirstPrefer
Prefer: SecPrefer
Prefer: ThirdPrefer
Accept: */*
</code></pre><p>Here&rsquo;s how the situation goes wrong.
If a HTTP request maliciously contains multiple <code>prefer</code> headers, it can make the program enter the <code>if</code>-block multiple times.
However, the function never nullifies <code>r->headers_in.prefer</code> after freeing the object. Consequently, the dangling pointer <code>r->headers_in.prefer</code> can be reused, which is a typical use-after-free scenario.</p><p>The sanitizer report for the given problematic input seems to exhibit &ldquo;all-we-have-to-know&rdquo; about this bug.</p><pre tabindex=0><code>==14==ERROR: AddressSanitizer: attempting double-free on 0x506000006d40 in thread T0:
SCARINESS: 42 (double-free)
    #0 0x5630699d7106 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x563069acd9cd in ngx_http_process_prefer /src/nginx/src/http/ngx_http_request.c:4018:9
    #2 0x563069adc761 in ngx_http_process_request_headers /src/nginx/src/http/ngx_http_request.c:1499:23
      [...omitted...]

DEDUP_TOKEN: __interceptor_free--ngx_http_process_prefer--ngx_http_process_request_headers
0x506000006d40 is located 0 bytes inside of 56-byte region [0x506000006d40,0x506000006d78)
freed by thread T0 here:
    #0 0x5630699d7106 in free /src/llvm-project/compiler-rt/lib/asan/asan_malloc_linux.cpp:52:3
    #1 0x563069acd9cd in ngx_http_process_prefer /src/nginx/src/http/ngx_http_request.c:4018:9
    #2 0x563069adc761 in ngx_http_process_request_headers /src/nginx/src/http/ngx_http_request.c:1499:23
      [...omitted...]
</code></pre><p>The report clearly indicates that the bug is a double-free in the <code>ngx_http_process_prefer</code> function.</p><p>So far, the bug is quite obvious and it looks easy to fix considering the current LLMs&rsquo; capabilities.
How can we fix this bug? A straightforward fix would be to nullify the pointer <code>r->headers_in.prefer</code> after <code>ngx_free</code>. By doing so, we would prevent the function from entering the problematic <code>if</code>-block repeatedly — and that was the exact way how LLMs thought.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#f92672>--- a/src/http/ngx_http_request.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/src/http/ngx_http_request.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span><span style=color:#75715e>@@ -4016,6 +4016,7 @@
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    &amp;h-&gt;key, &amp;h-&gt;value, &amp;r-&gt;headers_in.prefer-&gt;key,
</span></span><span style=display:flex><span>                    &amp;r-&gt;headers_in.prefer-&gt;value);
</span></span><span style=display:flex><span>        ngx_free(r-&gt;headers_in.prefer);
</span></span><span style=display:flex><span><span style=color:#a6e22e>+       r-&gt;headers_in.prefer = NULL; // Nullify to prevent further misuse (comment by LLMs)
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>        return NGX_OK;
</span></span><span style=display:flex><span>    }
</span></span></code></pre></div><p>Here&rsquo;s the typical patch that our patch agents produced.
As mentioned earlier, it nullifies the <code>r->headers_in.prefer</code> pointer to prevent further misuse.</p><p>However, it turned out that the problem was not that simple.
When handling each HTTP request, <code>nginx</code> requires &ldquo;rules&rdquo; to treat the failures.
To be specific, for problematic HTTP requests, each header handlers (like <code>ngx_http_process_prefer</code>) must finalize the HTTP request using <code>ngx_http_finalize_request</code> with a proper flag, and return the <code>NGX_ERROR</code> to indicate something went wrong with the request.
Without complying the rules, the patched program still suffers from another heap overflow caused by prefer header.</p><p>This implies that the agent must also consider project-specifc aspects rather than just fixing the observed symptom.</p><h2 id=guiding-llms-toward-the-right-way-property-analysis-layer>Guiding LLMs Toward the Right Way: Property-Analysis Layer</h2><p>The question is, how can we guide the LLMs to consider such &ldquo;project-specific&rdquo; aspect without losing generality?
To address this issue, our team borrowed the concept of <strong>properties</strong> from the field of software engineering and verification.</p><p>A program property is, usually described in a formal logical representation, is a statement about a program’s behavior that should hold true for all possible executions (or specific ones).</p><p>For example, here are properties in popular projects:</p><ul><li><strong>Safety Property</strong>: &ldquo;No null pointer dereference occurs during kernel execution.&rdquo; (Linux Kernel)</li><li><strong>Functional Property</strong>: &ldquo;After executing an <code>INSERT</code> statement, the database file contains the inserted row.&rdquo; (SQLite)</li></ul><p>Our team&rsquo;s strategy is to use this concept of properties to avoid context-agnostic patches that only addresses symptoms of security issues. To this end, Vincent agent added an intermediate layer that analyzes the program property just before generating patches.
Interestingly, LLMs seems to already have the concept of properties, enabling the use of concise prompt like below.</p><pre tabindex=0><code>    [...omitted...]
In formal terms, a property refers to a condition that must hold true across all possible execution traces (i.e., sequences of system states).
This means that every possible path the program can take during execution must satisfy the property.
    [...omitted...]
</code></pre><p>By using the property extraction prompt, Vincent agent infers the properties related to the given bug.
The following example is a partial list of program properties for the provided double-free bug when using Claude Sonnet 3.5 model.</p><ul><li><strong>Memory Safety</strong>: For any header field in <code>ngx_http_headers_in_t</code>, the pointer must either be <code>NULL</code> or point to a valid <code>ngx_table_elt_t</code> structure.</li><li><strong>Header Processing Consistency</strong>: All single-value HTTP headers (like Host, From, Content-Length) must maintain exactly one instance throughout the request processing lifecycle.</li><li><strong>Error Response Consistency</strong>: When encountering invalid headers, the system must either: (1) Return <code>NGX_ERROR</code> and call <code>ngx_http_finalize_request</code> with <code>NGX_HTTP_BAD_REQUEST</code> (2) Log the issue and return <code>NGX_OK</code> But never both or neither.</li></ul><p>The <strong>Error Response Consistency</strong> is one that LLMs failed to consider in the previous superficial patch.</p><p>By considering this property, Vincent agent managed to produce the following sound patch for the given <code>nginx</code> double-free bug:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=display:flex><span><span style=color:#f92672>--- a/src/http/ngx_http_request.c
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+++ b/src/http/ngx_http_request.c
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>         ngx_free(r-&gt;headers_in.prefer);
</span></span><span style=display:flex><span><span style=color:#f92672>-        return NGX_OK;
</span></span></span><span style=display:flex><span><span style=color:#f92672></span><span style=color:#a6e22e>+        r-&gt;headers_in.prefer = NULL;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        ngx_http_finalize_request(r, NGX_HTTP_BAD_REQUEST);
</span></span></span><span style=display:flex><span><span style=color:#a6e22e>+        return NGX_ERROR;
</span></span></span><span style=display:flex><span><span style=color:#a6e22e></span>     }
</span></span></code></pre></div><h2 id=workflow-of-vincent-agent>Workflow of Vincent Agent</h2><p>The overall workflow of <em>Vincent Agent</em> consists of three analysis steps as follows.</p><figure class="img-fluid text-center"><img src=images/blog/crs-patch/vincent_overview.png alt="Fig.1 High-level overview of Vincent Agent" width=70%><figcaption><p>Fig.1 High-level overview of <em>Vincent Agent</em></p></figcaption></figure><p>The initial step is the root cause analysis (RCA) step—a process that identifies the reason why the bug occurs. Given the sanitizer report and the PoC (Proof-of-Concept) input binary, Vincent lets the LLMs explore the codebase autonomously.
The next step is property analysis. Using the RCA report from the previous step, Vincent extracts relevant program properties with the help of the LLMs.
To infer more precise properties, the LLMs are allowed to further explore the codebase.
Finally, with the RCA and property analysis reports retained in the message context, Vincent instructs the LLMs to generate a security patch in diff format.</p><p>For each generated patch, Vincent applies it to the given project and validates whether the patch is sound. To do this, Vincent utilizes the OSS-Fuzz–based building and testing interfaces of Crete, our framework for developing patch agents.</p><p>As a result of patch validation, there are four possible outcomes: (i) sound, (ii) vulnerable, (iii) uncompilable, and (iv) test failure.
Except in the case of a sound patch, Vincent collects the related logs (e.g., sanitizer report, build error log, etc.) and delivers the information to the LLM to generate a new patch. Vincent repeats the patch generation–validation-feedback cycle until a sound patch is produced.</p><h2 id=code-retrieval-of-vincent-agent>Code Retrieval of Vincent Agent</h2><p>One of the core components that each patch agent should support is the code retrieval feature, which enables the LLMs to understand the codebase.
Based on our experience in internal evaluations, the precision of code retrieval and the performance of LLMs are highly correlated.
In Crete, we adopt various code retrieval strategies to ensure the robustness and responsiveness of our system.
In the case of Vincent Agent, we provide the LLMs with code information by combining the <code>ctags</code> utility and the <code>tree-sitter</code> library.</p><p><code>ctags</code> is a command-line utility that generates an index (or &ldquo;tags&rdquo; file) of symbols found in source code files—like functions, classes, variables, macros, etc.
<code>tree-sitter</code> is a modern parsing library designed to build incremental parsers for programming languages, primarily to provide fast, precise, and robust syntax analysis for code editors and tools.</p><p>Instead of providing entire source files, Vincent Agent pinpoints code snippets essential to the LLM&rsquo;s request.
Specifically, given a target symbol name, such as a function or variable, Vincent first locates where the requested code snippet exists using <code>ctags</code>.
Then, it extracts the actual code, including the surrounding context (e.g., the full implementation of a function, struct, enum, etc.), using <code>tree-sitter</code>.</p><p>Beyond this basic strategy, we observed occasional failures of <code>tree-sitter</code>&rsquo;s parser when dealing with complex codebases.
For example, if the target source code contains complex compile directives or macros, <code>tree-sitter</code> may fail to parse the intended snippets properly.
To handle such potential errors from external libraries, Vincent allows LLMs to request additional code lines when the initial query result is insufficient.</p><h2 id=conclusion>Conclusion</h2><p>In this blog post, we discussed one of the challenges our team struggled with and how the Vincent agent successfully solved it.
While LLMs can often fix surface-level bugs, they struggle with project-specific rules and invariants. By introducing a property analysis layer, Vincent guides LLMs to reason about deeper program semantics, resulting in sounder patches.
Integrated within the Crete framework, Vincent autonomously retrieves, analyzes, and validates patches in an iterative loop, improving both correctness and robustness.</p></div><div class="row items-start justify-between"><div class="lg:col-5 mb-10 flex items-center lg:mb-0"><h5 class=mr-3>Tags :</h5><ul><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/patch/>Patch</a></li><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/ensemble/>Ensemble</a></li><li class=inline-block><a class="bg-theme-light hover:bg-primary dark:bg-darkmode-theme-light dark:hover:bg-darkmode-primary dark:hover:text-dark m-1 block rounded px-3 py-1 hover:text-white" href=/tags/multi-agent/>Multi agent</a></li></ul></div><div class="lg:col-4 flex items-center"><div class=share-icons><a class="share-link share-facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f" target=_blank rel=noopener aria-label="share facebook"><span class=share-icon><svg viewBox="0 0 24 24"><path d="M18.77 7.46H14.5v-1.9c0-.9.6-1.1 1-1.1h3V.5h-4.33C10.24.5 9.5 3.44 9.5 5.32v2.15h-3v4h3v12h5v-12h3.85l.42-4z"/></svg>
</span></a><a class="share-link share-x" href="https://x.com/intent/tweet/?text=Share&amp;url=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f" target=_blank rel=noopener aria-label="share x"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M8 2H1l8.26 11.015L1.45 22H4.1l6.388-7.349L16 22h7l-8.608-11.478L21.8 2h-2.65l-5.986 6.886zm9 18L5 4h2l12 16z"/></svg>
</span></a><a class="share-link share-email" href="mailto:?subject=Share&amp;body=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f" target=_self rel=noopener aria-label="share email"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M22 4H2C.9 4 0 4.9.0 6v12c0 1.1.9 2 2 2h20c1.1.0 2-.9 2-2V6c0-1.1-.9-2-2-2zM7.25 14.43l-3.5 2c-.08.05-.17.07-.25.07-.17.0-.34-.1-.43-.25-.14-.24-.06-.55.18-.68l3.5-2c.24-.14.55-.06.68.18.14.24.06.55-.18.68zm4.75.07c-.1.0-.2-.03-.27-.08l-8.5-5.5c-.23-.15-.3-.46-.15-.7.15-.22.46-.3.7-.14L12 13.4l8.23-5.32c.23-.15.54-.08.7.15.14.23.07.54-.16.7l-8.5 5.5c-.08.04-.17.07-.27.07zm8.93 1.75c-.1.16-.26.25-.43.25-.08.0-.17-.02-.25-.07l-3.5-2c-.24-.13-.32-.44-.18-.68s.44-.32.68-.18l3.5 2c.24.13.32.44.18.68z"/></svg>
</span></a><a class="share-link share-reddit" href="https://reddit.com/submit/?url=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f&amp;resubmit=true&amp;title=Share" target=_blank rel=noopener aria-label="share reddit"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M24 11.5c0-1.65-1.35-3-3-3-.96.0-1.86.48-2.42 1.24-1.64-1-3.75-1.64-6.07-1.72.08-1.1.4-3.05 1.52-3.7.72-.4 1.73-.24 3 .5C17.2 6.3 18.46 7.5 20 7.5c1.65.0 3-1.35 3-3s-1.35-3-3-3c-1.38.0-2.54.94-2.88 2.22-1.43-.72-2.64-.8-3.6-.25-1.64.94-1.95 3.47-2 4.55-2.33.08-4.45.7-6.1 1.72C4.86 8.98 3.96 8.5 3 8.5c-1.65.0-3 1.35-3 3 0 1.32.84 2.44 2.05 2.84-.03.22-.05.44-.05.66.0 3.86 4.5 7 10 7s10-3.14 10-7c0-.22-.02-.44-.05-.66 1.2-.4 2.05-1.54 2.05-2.84zM2.3 13.37C1.5 13.07 1 12.35 1 11.5c0-1.1.9-2 2-2 .64.0 1.22.32 1.6.82-1.1.85-1.92 1.9-2.3 3.05zm3.7.13c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm9.8 4.8c-1.08.63-2.42.96-3.8.96-1.4.0-2.74-.34-3.8-.95-.24-.13-.32-.44-.2-.68.15-.24.46-.32.7-.18 1.83 1.06 4.76 1.06 6.6.0.23-.13.53-.05.67.2.14.23.06.54-.18.67zm.2-2.8c-1.1.0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm5.7-2.13c-.38-1.16-1.2-2.2-2.3-3.05.38-.5.97-.82 1.6-.82 1.1.0 2 .9 2 2 0 .84-.53 1.57-1.3 1.87z"/></svg>
</span></a><a class="share-link share-linkedin" href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f" target=_blank rel=noopener aria-label="share linkedin"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853.0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601.0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433A2.062 2.062.0 013.274 5.368a2.064 2.064.0 112.063 2.065m1.782 13.019H3.555V9h3.564zM22.225.0H1.771C.792.0.0.774.0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2.0 22.222.0z"/></svg>
</span></a><a class="share-link share-pinterest" href="http://pinterest.com/pin/create/link/?url=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f" target=_blank rel=noopener aria-label="share linkedin"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M12.017.0C5.396.0.029 5.367.029 11.987c0 5.079 3.158 9.417 7.618 11.162-.105-.949-.199-2.403.041-3.439.219-.937 1.406-5.957 1.406-5.957s-.359-.72-.359-1.781c0-1.663.967-2.911 2.168-2.911 1.024.0 1.518.769 1.518 1.688.0 1.029-.653 2.567-.992 3.992-.285 1.193.6 2.165 1.775 2.165 2.128.0 3.768-2.245 3.768-5.487.0-2.861-2.063-4.869-5.008-4.869-3.41.0-5.409 2.562-5.409 5.199.0 1.033.394 2.143.889 2.741.099.12.112.225.085.345-.09.375-.293 1.199-.334 1.363-.053.225-.172.271-.401.165-1.495-.69-2.433-2.878-2.433-4.646.0-3.776 2.748-7.252 7.92-7.252 4.158.0 7.392 2.967 7.392 6.923.0 4.135-2.607 7.462-6.233 7.462-1.214.0-2.354-.629-2.758-1.379l-.749 2.848c-.269 1.045-1.004 2.352-1.498 3.146 1.123.345 2.306.535 3.55.535 6.607.0 11.985-5.365 11.985-11.987C23.97 5.39 18.592.026 11.985.026z"/></svg>
</span></a><a class="share-link share-tumblr" href="https://www.tumblr.com/widgets/share/tool?canonicalUrl=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f&title=Share" target=_blank rel=noopener aria-label="share linkedin"><span aria-hidden=true class=share-icon><svg viewBox="0 0 20 20"><path d="M10 .4C4.698.4.4 4.698.4 10s4.298 9.6 9.6 9.6 9.6-4.298 9.6-9.6S15.302.4 10 .4m2.577 13.741a5.508 5.508.0 01-1.066.395 4.543 4.543.0 01-1.031.113c-.42.0-.791-.055-1.114-.162a2.373 2.373.0 01-.826-.459 1.651 1.651.0 01-.474-.633c-.088-.225-.132-.549-.132-.973V9.16H6.918V7.846c.359-.119.67-.289.927-.512.257-.221.464-.486.619-.797.156-.31.263-.707.322-1.185h1.307v2.35h2.18V9.16h-2.18v2.385c0 .539.028.885.085 1.037a.7.7.0 00.315.367c.204.123.437.185.697.185.466.0.928-.154 1.388-.461z"/></svg>
</span></a><a class="share-link share-vk" href="http://vk.com/share.php?url=https%3a%2f%2fteam-atlanta.github.io%2fblog%2fpost-crs-patch-agent-vincent%2f&title=Share" target=_blank rel=noopener aria-label="share linkedin"><span aria-hidden=true class=share-icon><svg viewBox="0 0 24 24"><path d="M15.684.0H8.316C1.592.0.0 1.592.0 8.316v7.368C0 22.408 1.592 24 8.316 24h7.368C22.408 24 24 22.408 24 15.684V8.316C24 1.592 22.391.0 15.684.0zm3.692 17.123h-1.744c-.66.0-.864-.525-2.05-1.727-1.033-1-1.49-1.135-1.744-1.135-.356.0-.458.102-.458.593v1.575c0 .424-.135.678-1.253.678-1.846.0-3.896-1.118-5.335-3.202C4.624 10.857 4.03 8.57 4.03 8.096c0-.254.102-.491.593-.491h1.744c.44.0.61.203.78.677.863 2.49 2.303 4.675 2.896 4.675.22.0.322-.102.322-.66V9.721c-.068-1.186-.695-1.287-.695-1.71.0-.204.17-.407.44-.407h2.744c.373.0.508.203.508.643v3.473c0 .372.17.508.271.508.22.0.407-.136.813-.542 1.254-1.406 2.151-3.574 2.151-3.574.119-.254.322-.491.763-.491h1.744c.525.0.644.27.525.643-.22 1.017-2.354 4.031-2.354 4.031-.186.305-.254.44.0.78.186.254.796.779 1.203 1.253.745.847 1.32 1.558 1.473 2.05.17.49-.085.744-.576.744z"/></svg>
</span></a><span class=fediverse-share><a class="share-link share-fediverse" href=javascript:void(0); onclick=toggleFediverseInput(this) aria-label="share fediverse"><span aria-hidden=true class=share-icon><svg viewBox="-10 -5 1034 1034" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="SVGRepo_bgCarrier" stroke-width="0"/><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"/><g id="SVGRepo_iconCarrier"><path d="M539 176q-32 0-55 22t-25 55 20.5 58 56 27 58.5-20.5 27-56-20.5-59T544 176h-5zm-87 95-232 118q20 20 25 48l231-118q-19-20-24-48zm167 27q-13 25-38 38l183 184q13-25 39-38zM477 320 342 585l40 40 143-280q-28-5-48-25zm104 16q-22 11-46 10l-8-1 21 132 56 9zM155 370q-32 0-55 22.5t-25 55 20.5 58 56.5 27 59-21 26.5-56-21-58.5-55.5-27h-6zm90 68q1 9 1 18-1 19-10 35l132 21 26-50zm225 36-26 51 311 49q-1-8-1-17 1-19 10-36zm372 6q-32 1-55 23t-24.5 55 21 58 56 27 58.5-20.5 27-56.5-20.5-59-56.5-27h-6zM236 493q-13 25-39 38l210 210 51-25zm-40 38q-21 11-44 10l-9-1 40 256q21-10 45-9l8 1zm364 22 48 311q21-10 44-9l10 1-46-294zm195 23-118 60 8 56 135-68q-20-20-25-48zm26 49-119 231q28 5 48 25l119-231q-28-5-48-25zM306 654l-68 134q28 5 48 25l60-119zm262 17-281 143q19 20 24 48l265-135zM513 771l-51 25 106 107q13-25 39-38zM222 795q-32 0-55.5 22.5t-25 55 21 57.5 56 27 58.5-20.5 27-56-20.5-58.5-56.5-27h-5zm89 68q2 9 1 18-1 19-9 35l256 41q-1-9-1-18 1-18 10-35zm335 0q-32 0-55 22.5t-24.5 55 20.5 58 56 27 59-21 27-56-20.5-58.5-56.5-27h-6z"/></g></svg>
</span></a><span class=fediverse-input-wrapper style=display:none><input type=text placeholder="Enter Fediverse Instance URL" class=fediverse-input onkeypress='handleFediverseShare(event,"https://team-atlanta.github.io/blog/post-crs-patch-agent-vincent/","Share")'>
<button class=fediverse-check-button onclick='handleFediverseShareButton(this,"https://team-atlanta.github.io/blog/post-crs-patch-agent-vincent/","Share")'>
Share
</button>
</span></span><button class="share-link share-copy" onclick='copyToClipboard(this,"https://team-atlanta.github.io/blog/post-crs-patch-agent-vincent/")'>
<span class=share-icon><svg viewBox="0 0 24 24"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1.0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1.0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7-1c.55.0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 17H5V5h14v14z"/></svg></span></button></div><script>function toggleFediverseInput(e){const n=e.closest(".fediverse-share"),t=n.querySelector(".fediverse-input-wrapper");t.style.display=t.style.display==="none"?"block":"none"}function handleFediverseShare(e,t,n){if(e.key==="Enter"){const o=e.target;let s=o.value.trim();if(s){s.startsWith("https://")||(s=`https://${s}`);const e=`${s}/share?text=${encodeURIComponent(n)}&url=${encodeURIComponent(t)}`;window.open(e,"_blank","noopener")}}}function handleFediverseShareButton(e,t,n){const o=e.previousElementSibling;let s=o.value.trim();if(s){s.startsWith("https://")||(s=`https://${s}`);const e=`${s}/share?text=${encodeURIComponent(n)}&url=${encodeURIComponent(t)}`;window.open(e,"_blank","noopener")}}function copyToClipboard(e,t){navigator.clipboard.writeText(t).then(()=>{const t=e.querySelector("svg path"),n="M19 3h-4.18C14.4 1.84 13.3 1 12 1s-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7-1c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm7 17H5V5h14v14z",s="M9 16.2l-3.5-3.5-1.4 1.4L9 19 20 8l-1.4-1.4L9 16.2z";t.setAttribute("d",s),setTimeout(()=>{t.setAttribute("d",n)},1e3)})}</script></div></div></article></div><div class="section pb-0"><h2 class="h3 mb-12">Related Posts</h2><div class=row><div class=lg:col-4><div class="blog-card-uniform glass-card p-6 group border border-gray-200/20 dark:border-gray-700/30 h-full"><div class="blog-card-content flex flex-col h-full"><div class="blog-card-image mb-4"><div class="relative overflow-hidden rounded-xl aspect-video"><picture><source srcset=/images/blog/mlla/preview_hu_4b585ec467fec953.webp media="(max-width: 575px)"><source srcset=/images/blog/mlla/preview_hu_d29297802763e836.webp media="(max-width: 767px)"><source srcset=/images/blog/mlla/preview_hu_db9af3aecbb3b204.webp media="(max-width: 991px)"><source srcset=/images/blog/mlla/preview_hu_5bc9a2a0a8539a4a.webp><img loading=lazy decoding=async src=/images/blog/mlla/preview_hu_8e8f0a71ba085209.png class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 img" alt="MLLA: Teaching LLMs to Hunt Bugs Like Security Researchers" width=1248 height=832></picture><div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div></div></div><div class="blog-card-body flex-grow flex flex-col"><h4 class="blog-card-title mb-3 line-clamp-3 group-hover:text-primary transition-colors duration-300"><a href=/blog/post-mlla-overview/ class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300 font-semibold text-lg leading-tight" title="MLLA: Teaching LLMs to Hunt Bugs Like Security Researchers">MLLA: Teaching LLMs to Hunt Bugs Like Security Researchers</a></h4><div class="blog-card-meta mb-4 text-sm text-gray-600 dark:text-gray-300 space-y-1"><div class="flex items-center min-h-[20px]"><i class="fa-regular fa-user-group mr-2 text-primary flex-shrink-0"></i><div class="flex flex-wrap items-center gap-x-1"><a href=/authors/dongkwan-kim/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Dongkwan Kim</a>,
<a href=/authors/soyeon-park/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Soyeon Park</a></div></div><div class="flex items-center min-h-[20px]"><i class="fa-regular fa-folder mr-2 text-primary flex-shrink-0"></i><div class="flex flex-wrap items-center gap-x-1"><a href=/categories/atlantis-multilang/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Atlantis multilang</a></div></div></div><p class="blog-card-summary mb-4 text-gray-700 dark:text-gray-300 leading-relaxed line-clamp-4 flex-grow">When Fuzzing Meets Intelligence Picture this: you&rsquo;re a security researcher staring at 20 million lines of code, hunting for vulnerabilities that could compromise everything from your smartphone to critical infrastructure. Traditional fuzzers approach this challenge with brute force – throwing millions of random inputs at the program like a toddler mashing keyboard keys. Sometimes it works. Often, it doesn&rsquo;t.
But what if we could change the game entirely?
Meet MLLA (Multi-Language LLM Agent) – the most ambitious experiment in AI-assisted vulnerability discovery we&rsquo;ve ever built. Instead of random chaos, MLLA thinks, plans, and hunts bugs like an experienced security researcher, but at machine scale.</p></div><div class="blog-card-footer mt-auto"><a class="btn btn-outline-primary btn-sm hover:bg-gradient-modern hover:text-white hover:border-transparent transition-all duration-300 inline-flex items-center w-full justify-center" href=/blog/post-mlla-overview/>Read More
<i class="fa fa-arrow-right ml-2 text-xs transition-transform duration-300 group-hover:translate-x-1"></i></a></div></div></div></div><div class=lg:col-4><div class="blog-card-uniform glass-card p-6 group border border-gray-200/20 dark:border-gray-700/30 h-full"><div class="blog-card-content flex flex-col h-full"><div class="blog-card-image mb-4"><div class="relative overflow-hidden rounded-xl aspect-video"><picture><source srcset=/images/blog/crs-java/libafl-jazzer/jazzer_plus_libafl_hu_382ebbbf5f489429.webp media="(max-width: 575px)"><source srcset=/images/blog/crs-java/libafl-jazzer/jazzer_plus_libafl_hu_d6be100e3efb493b.webp media="(max-width: 767px)"><source srcset=/images/blog/crs-java/libafl-jazzer/jazzer_plus_libafl_hu_85d33c2872aa7d6d.webp media="(max-width: 991px)"><source srcset=/images/blog/crs-java/libafl-jazzer/jazzer_plus_libafl_hu_9a86debab8eacf42.webp><img loading=lazy decoding=async src=/images/blog/crs-java/libafl-jazzer/jazzer_plus_libafl_hu_af41ab2119729508.png class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 img" alt="Jazzer+LibAFL: Insights into Java Fuzzing" width=1100 height=700></picture><div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div></div></div><div class="blog-card-body flex-grow flex flex-col"><h4 class="blog-card-title mb-3 line-clamp-3 group-hover:text-primary transition-colors duration-300"><a href=/blog/post-crs-java-libafl-jazzer/ class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300 font-semibold text-lg leading-tight" title="Jazzer+LibAFL: Insights into Java Fuzzing">Jazzer+LibAFL: Insights into Java Fuzzing</a></h4><div class="blog-card-meta mb-4 text-sm text-gray-600 dark:text-gray-300 space-y-1"><div class="flex items-center min-h-[20px]"><a href=/authors/ammar-askar/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300 flex items-center"><i class="fa-regular fa-circle-user mr-2 text-primary"></i>Ammar Askar</a></div><div class="flex items-center min-h-[20px]"><i class="fa-regular fa-folder mr-2 text-primary flex-shrink-0"></i><div class="flex flex-wrap items-center gap-x-1"><a href=/categories/atlantis-java/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Atlantis java</a></div></div></div><p class="blog-card-summary mb-4 text-gray-700 dark:text-gray-300 leading-relaxed line-clamp-4 flex-grow">AIxCC involved finding bugs in software written in two languages: C++ and Java. The focus of the competition was on the use of LLMs and AI, however, our teams approach was to balance ambitious strategies alongside proven traditional bug-finding techniques like fuzzing. While our team was deeply familiar with fuzzing C++ from decades of academic research and industry work, Java was uncharted territory for us. In part of our Java fuzzing development we created a fork of Jazzer that uses LibAFL as the fuzzing backend and it is available as part of our open source release. This post details some of the lessons we learned about Java fuzzing and the creation of this fork.</p></div><div class="blog-card-footer mt-auto"><a class="btn btn-outline-primary btn-sm hover:bg-gradient-modern hover:text-white hover:border-transparent transition-all duration-300 inline-flex items-center w-full justify-center" href=/blog/post-crs-java-libafl-jazzer/>Read More
<i class="fa fa-arrow-right ml-2 text-xs transition-transform duration-300 group-hover:translate-x-1"></i></a></div></div></div></div><div class=lg:col-4><div class="blog-card-uniform glass-card p-6 group border border-gray-200/20 dark:border-gray-700/30 h-full"><div class="blog-card-content flex flex-col h-full"><div class="blog-card-image mb-4"><div class="relative overflow-hidden rounded-xl aspect-video"><picture><source srcset=/images/blog/custom-model/preview_hu_6b036da9e49dc515.webp media="(max-width: 575px)"><source srcset=/images/blog/custom-model/preview_hu_12f042785c581ea8.webp media="(max-width: 767px)"><source srcset=/images/blog/custom-model/preview_hu_f5cc79edeb77ccdc.webp media="(max-width: 991px)"><source srcset=/images/blog/custom-model/preview_hu_462d6cea21c63a37.webp><img loading=lazy decoding=async src=/images/blog/custom-model/preview_hu_d5664695654ab608.png class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300 img" alt="Teaching LLMs to Retrieve: Custom Models for Security Patch Generation" width=1536 height=1024></picture><div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div></div></div><div class="blog-card-body flex-grow flex flex-col"><h4 class="blog-card-title mb-3 line-clamp-3 group-hover:text-primary transition-colors duration-300"><a href=/blog/post-custom-model/ class="text-gray-900 dark:text-white hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300 font-semibold text-lg leading-tight" title="Teaching LLMs to Retrieve: Custom Models for Security Patch Generation">Teaching LLMs to Retrieve: Custom Models for Security Patch Generation</a></h4><div class="blog-card-meta mb-4 text-sm text-gray-600 dark:text-gray-300 space-y-1"><div class="flex items-center min-h-[20px]"><i class="fa-regular fa-user-group mr-2 text-primary flex-shrink-0"></i><div class="flex flex-wrap items-center gap-x-1"><a href=/authors/minjae-gwon/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Minjae Gwon</a>,
<a href=/authors/sangdon-park/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Sangdon Park</a></div></div><div class="flex items-center min-h-[20px]"><i class="fa-regular fa-folder mr-2 text-primary flex-shrink-0"></i><div class="flex flex-wrap items-center gap-x-1"><a href=/categories/atlantis-patch/ class="hover:text-blue-600 dark:hover:text-blue-400 transition-colors duration-300">Atlantis patch</a></div></div></div><p class="blog-card-summary mb-4 text-gray-700 dark:text-gray-300 leading-relaxed line-clamp-4 flex-grow">The Typedef That Changed Everything Picture this: you&rsquo;re asking an LLM to patch a security vulnerability in Nginx, a codebase with millions of lines. The bug is clear, the fix location is obvious, but your patch won&rsquo;t compile. Why? Because buried somewhere in the headers are two critical typedef definitions that the LLM never saw.
We discovered this the hard way during the AIxCC Semifinals. Challenge challenge-004-nginx-cp/cpv15 became our wake-up call. When we ran our baseline patching agent Aider 20 times without the typedef definitions, only 5 patches compiled successfully. But when we included those typedefs? 18 out of 20 compiled successfully. That 5/20 → 18/20 leap wasn&rsquo;t about smarter LLMs or better prompts. It was about giving the right context.</p></div><div class="blog-card-footer mt-auto"><a class="btn btn-outline-primary btn-sm hover:bg-gradient-modern hover:text-white hover:border-transparent transition-all duration-300 inline-flex items-center w-full justify-center" href=/blog/post-custom-model/>Read More
<i class="fa fa-arrow-right ml-2 text-xs transition-transform duration-300 group-hover:translate-x-1"></i></a></div></div></div></div></div></div></div></section></main><footer class=footer-modern><div class=container><div class="row items-center py-10"><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:text-left"><a class="navbar-brand inline-block" href=/>Team Atlanta</a></div><div class="lg:col-6 mb-8 text-center lg:mb-0"><ul><li class="m-3 inline-block"><a href=/>Home</a></li><li class="m-3 inline-block"><a href=/authors/>AIxCC Team</a></li><li class="m-3 inline-block"><a href=/artifacts/>Research & Code</a></li><li class="m-3 inline-block"><a href=/news/>News</a></li><li class="m-3 inline-block"><a href=/blog/>Blog</a></li></ul></div><div class="lg:col-3 mb-8 text-center lg:mb-0 lg:mt-0 lg:text-right"><ul class=social-icons><li><a target=_blank aria-label=www rel="nofollow noopener" href=https://team-atlanta.github.io/><i class="fa-solid fa-house"></i></a></li><li><a target=_blank aria-label=github rel="nofollow noopener" href=https://github.com/Team-Atlanta/><i class="fab fa-github"></i></a></li><li><a target=_blank aria-label=twitter rel="nofollow noopener" href=https://x.com/TeamAtlanta24><i class="fab fa-twitter"></i></a></li><li><a target=_blank aria-label=linkedin rel="nofollow noopener" href=https://www.linkedin.com/company/team-atlanta><i class="fab fa-linkedin"></i></a></li></ul></div></div></div><div class="border-border dark:border-darkmode-border border-t py-7"><div class="text-light dark:text-darkmode-light container text-center"><p>© 2025 Team Atlanta. All rights reserved.</p></div></div></footer><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js type=application/javascript integrity=sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8 crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js type=application/javascript integrity=sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05 crossorigin=anonymous></script><script crossorigin=anonymous integrity="sha256-B7RG2Ruj95Xs9yKm5TMMEHSUEPr/AxlT0Oa6s6hJEns=" src=/js/script.min.07b446d91ba3f795ecf722a6e5330c10749410faff031953d0e6bab3a849127b.js></script><script defer async crossorigin=anonymous integrity="sha256-mO+0eEK92H/51vGvDl7SHTg5P+PZdLEqF442tt2/4/k=" src=/js/script-lazy.min.98efb47842bdd87ff9d6f1af0e5ed21d38393fe3d974b12a178e36b6ddbfe3f9.js></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js")</script></body></html>